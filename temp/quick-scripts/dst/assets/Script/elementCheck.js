
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/Script/elementCheck.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'a3721/aOY1GFrIWHHBzYGsi', 'elementCheck');
// Script/elementCheck.js

"use strict";

/**
 * @author heyuchang
 * @file 检测组件
 */
cc.Class({
  "extends": cc.Component,
  properties: {
    groups: [],
    map: [],
    mapLength: 8
  },
  init: function init(g) {
    this._game = g;
    this.map = g.map;
    this.mapLength = g.rowCfgNum;

    for (var i = 0; i < this.mapLength; i++) {
      //行
      this.groups[i] = [];

      for (var j = 0; j < this.mapLength; j++) {
        //列
        // this.map[i][j].getComponent('element').growInit() //全部初始化
        if (!this.map[i][j]) {//    cc.log('报错x,y:', i, j)
        }

        this.map[i][j].getComponent('element').isSingle = false;
        this.map[i][j].getComponent('element').warningInit();
        this.groups[i][j] = [];
      }
    }
  },
  elementCheck: function elementCheck(g) {
    //该函数主要用于检测一个区块能否形成道具等
    var propConfig = g._gameController.config.json.propConfig;
    this._game = g;
    this.map = g.map;
    this.mapLength = g.rowCfgNum;
    var min = 999;

    for (var i = 0; i < propConfig.length; i++) {
      min = propConfig[i].min < min ? propConfig[i].min : min;
    }

    for (var _i = 0; _i < this.mapLength; _i++) {
      //行
      for (var j = 0; j < this.mapLength; j++) {
        //列
        this.pushPop(this.map[_i][j], _i, j);
        var target = this.map[_i][j];
        var x = target.getComponent('element').iid;
        var y = target.getComponent('element').jid;
        var isSingle = true;

        if (x - 1 >= 0 && this.map[x - 1][y].getComponent('element').color == target.getComponent('element').color) {
          isSingle = false;
        }

        if (x + 1 < this.mapLength && this.map[x + 1][y].getComponent('element').color == target.getComponent('element').color) {
          isSingle = false;
        }

        if (y - 1 >= 0 && this.map[x][y - 1].getComponent('element').color == target.getComponent('element').color) {
          isSingle = false;
        }

        if (y + 1 < this.mapLength && this.map[x][y + 1].getComponent('element').color == target.getComponent('element').color) {
          isSingle = false;
        }

        this.map[_i][j].getComponent('element').isSingle = isSingle;
        console.log(_i, j, this.map[_i][j].getComponent('element').isSingle, this.map[_i][j].getComponent('element').color);

        if (this.groups[_i][j].length >= min) {
          for (var z = 0; z < propConfig.length; z++) {
            if (this.groups[_i][j].length <= propConfig[z].max && this.groups[_i][j].length >= propConfig[z].min) {
              this.warning(propConfig[z].type, this.groups[_i][j]);
            }
          }
        }
      }
    }
  },
  pushPop: function pushPop(target, i, j) {
    //用于判断一个方块四个方向上的方块颜色是否一样 如果一样则加入组 如果组长度小于1则返回false?
    // if (target.getComponent('element').isPush==true) {
    //   return
    // }
    target.getComponent('element').isPush = true;
    this.groups[i][j].push(target);
    var x = target.getComponent('element').iid;
    var y = target.getComponent('element').jid;

    if (x - 1 >= 0) {
      if (!this.map[x - 1][y].getComponent('element').isPush && this.map[x - 1][y].getComponent('element').color == target.getComponent('element').color) {
        this.pushPop(this.map[x - 1][y], i, j);
      }
    }

    if (x + 1 < this.mapLength) {
      if (!this.map[x + 1][y].getComponent('element').isPush && this.map[x + 1][y].getComponent('element').color == target.getComponent('element').color) {
        this.pushPop(this.map[x + 1][y], i, j);
      }
    }

    if (y - 1 >= 0) {
      if (!this.map[x][y - 1].getComponent('element').isPush && this.map[x][y - 1].getComponent('element').color == target.getComponent('element').color) {
        this.pushPop(this.map[x][y - 1], i, j);
      }
    }

    if (y + 1 < this.mapLength) {
      if (!this.map[x][y + 1].getComponent('element').isPush && this.map[x][y + 1].getComponent('element').color == target.getComponent('element').color) {
        this.pushPop(this.map[x][y + 1], i, j);
      }
    } // 判断方块是否单身

  },
  warning: function warning(type, group) {
    group.map(function (item) {
      item.getComponent('element').onWarning(type);
    });
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcU2NyaXB0XFxlbGVtZW50Q2hlY2suanMiXSwibmFtZXMiOlsiY2MiLCJDbGFzcyIsIkNvbXBvbmVudCIsInByb3BlcnRpZXMiLCJncm91cHMiLCJtYXAiLCJtYXBMZW5ndGgiLCJpbml0IiwiZyIsIl9nYW1lIiwicm93Q2ZnTnVtIiwiaSIsImoiLCJnZXRDb21wb25lbnQiLCJpc1NpbmdsZSIsIndhcm5pbmdJbml0IiwiZWxlbWVudENoZWNrIiwicHJvcENvbmZpZyIsIl9nYW1lQ29udHJvbGxlciIsImNvbmZpZyIsImpzb24iLCJtaW4iLCJsZW5ndGgiLCJwdXNoUG9wIiwidGFyZ2V0IiwieCIsImlpZCIsInkiLCJqaWQiLCJjb2xvciIsImNvbnNvbGUiLCJsb2ciLCJ6IiwibWF4Iiwid2FybmluZyIsInR5cGUiLCJpc1B1c2giLCJwdXNoIiwiZ3JvdXAiLCJpdGVtIiwib25XYXJuaW5nIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBOzs7O0FBSUFBLEVBQUUsQ0FBQ0MsS0FBSCxDQUFTO0FBQ1AsYUFBU0QsRUFBRSxDQUFDRSxTQURMO0FBRVBDLEVBQUFBLFVBQVUsRUFBRTtBQUNWQyxJQUFBQSxNQUFNLEVBQUUsRUFERTtBQUVWQyxJQUFBQSxHQUFHLEVBQUUsRUFGSztBQUdWQyxJQUFBQSxTQUFTLEVBQUU7QUFIRCxHQUZMO0FBT1BDLEVBQUFBLElBUE8sZ0JBT0ZDLENBUEUsRUFPQztBQUNOLFNBQUtDLEtBQUwsR0FBYUQsQ0FBYjtBQUNBLFNBQUtILEdBQUwsR0FBV0csQ0FBQyxDQUFDSCxHQUFiO0FBQ0EsU0FBS0MsU0FBTCxHQUFpQkUsQ0FBQyxDQUFDRSxTQUFuQjs7QUFDQSxTQUFLLElBQUlDLENBQUMsR0FBRyxDQUFiLEVBQWdCQSxDQUFDLEdBQUcsS0FBS0wsU0FBekIsRUFBb0NLLENBQUMsRUFBckMsRUFBeUM7QUFBRTtBQUN6QyxXQUFLUCxNQUFMLENBQVlPLENBQVosSUFBaUIsRUFBakI7O0FBQ0EsV0FB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QixDQUFULEVBQVlFLENBQUMsR0FBRyxDQUFoQixDQUFiLEVBQWlDaEIsQ0FBakMsRUFBb0NDLENBQXBDO0FBQ0Q7QUFDRjs7QUFDRCxRQUFLZSxDQUFDLEdBQUcsQ0FBTCxHQUFVLEtBQUtyQixTQUFuQixFQUE4QjtBQUM1QixVQUFJLENBQUMsS0FBS0QsR0FBTCxDQUFTb0IsQ0FBVCxFQUFZRSxDQUFDLEdBQUcsQ0FBaEIsRUFBbUJkLFlBQW5CLENBQWdDLFNBQWhDLEVBQTJDdUIsTUFBNUMsSUFBc0QsS0FBSy9CLEdBQUwsQ0FBU29CLENBQVQsRUFBWUUsQ0FBQyxHQUFHLENBQWhCLEVBQW1CZCxZQUFuQixDQUFnQyxTQUFoQyxFQUEyQ2dCLEtBQTNDLElBQW9ETCxNQUFNLENBQUNYLFlBQVAsQ0FBb0IsU0FBcEIsRUFBK0JnQixLQUE3SSxFQUFvSjtBQUNsSixhQUFLTixPQUFMLENBQWEsS0FBS2xCLEdBQUwsQ0FBU29CLENBQVQsRUFBWUUsQ0FBQyxHQUFHLENBQWhCLENBQWIsRUFBaUNoQixDQUFqQyxFQUFvQ0MsQ0FBcEM7QUFDRDtBQUNGLEtBM0JtQixDQTZCcEI7O0FBRUQsR0FoR007QUFpR1BzQixFQUFBQSxPQWpHTyxtQkFpR0NDLElBakdELEVBaUdPRyxLQWpHUCxFQWlHYztBQUNuQkEsSUFBQUEsS0FBSyxDQUFDakMsR0FBTixDQUFVLFVBQUFrQyxJQUFJLEVBQUk7QUFDaEJBLE1BQUFBLElBQUksQ0FBQzFCLFlBQUwsQ0FBa0IsU0FBbEIsRUFBNkIyQixTQUE3QixDQUF1Q0wsSUFBdkM7QUFDRCxLQUZEO0FBR0Q7QUFyR00sQ0FBVCIsInNvdXJjZVJvb3QiOiIvIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIEBhdXRob3IgaGV5dWNoYW5nXHJcbiAqIEBmaWxlIOajgOa1i+e7hOS7tlxyXG4gKi9cclxuY2MuQ2xhc3Moe1xyXG4gIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuICBwcm9wZXJ0aWVzOiB7XHJcbiAgICBncm91cHM6IFtdLFxyXG4gICAgbWFwOiBbXSxcclxuICAgIG1hcExlbmd0aDogOFxyXG4gIH0sXHJcbiAgaW5pdChnKSB7XHJcbiAgICB0aGlzLl9nYW1lID0gZ1xyXG4gICAgdGhpcy5tYXAgPSBnLm1hcFxyXG4gICAgdGhpcy5tYXBMZW5ndGggPSBnLnJvd0NmZ051bVxyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm1hcExlbmd0aDsgaSsrKSB7IC8v6KGMXHJcbiAgICAgIHRoaXMuZ3JvdXBzW2ldID0gW11cclxuICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLm1hcExlbmd0aDsgaisrKSB7IC8v5YiXXHJcbiAgICAgICAgLy8gdGhpcy5tYXBbaV1bal0uZ2V0Q29tcG9uZW50KCdlbGVtZW50JykuZ3Jvd0luaXQoKSAvL+WFqOmDqOWIneWni+WMllxyXG4gICAgICAgIGlmICghdGhpcy5tYXBbaV1bal0pIHtcclxuICAgICAgICAgIC8vICAgIGNjLmxvZygn5oql6ZSZeCx5OicsIGksIGopXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMubWFwW2ldW2pdLmdldENvbXBvbmVudCgnZWxlbWVudCcpLmlzU2luZ2xlID0gZmFsc2VcclxuICAgICAgICB0aGlzLm1hcFtpXVtqXS5nZXRDb21wb25lbnQoJ2VsZW1lbnQnKS53YXJuaW5nSW5pdCgpXHJcbiAgICAgICAgdGhpcy5ncm91cHNbaV1bal0gPSBbXVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfSxcclxuICBlbGVtZW50Q2hlY2soZykgeyAvL+ivpeWHveaVsOS4u+imgeeUqOS6juajgOa1i+S4gOS4quWMuuWdl+iDveWQpuW9ouaIkOmBk+WFt+etiVxyXG4gICAgbGV0IHByb3BDb25maWcgPSBnLl9nYW1lQ29udHJvbGxlci5jb25maWcuanNvbi5wcm9wQ29uZmlnXHJcbiAgICB0aGlzLl9nYW1lID0gZ1xyXG4gICAgdGhpcy5tYXAgPSBnLm1hcFxyXG4gICAgdGhpcy5tYXBMZW5ndGggPSBnLnJvd0NmZ051bVxyXG4gICAgbGV0IG1pbiA9IDk5OVxyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwcm9wQ29uZmlnLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgIG1pbiA9IHByb3BDb25maWdbaV0ubWluIDwgbWluID8gcHJvcENvbmZpZ1tpXS5taW4gOiBtaW5cclxuICAgIH1cclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5tYXBMZW5ndGg7IGkrKykgeyAvL+ihjFxyXG4gICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHRoaXMubWFwTGVuZ3RoOyBqKyspIHsgLy/liJdcclxuICAgICAgICB0aGlzLnB1c2hQb3AodGhpcy5tYXBbaV1bal0sIGksIGopXHJcbiAgICAgICAgbGV0IHRhcmdldCA9IHRoaXMubWFwW2ldW2pdXHJcbiAgICAgICAgbGV0IHggPSB0YXJnZXQuZ2V0Q29tcG9uZW50KCdlbGVtZW50JykuaWlkXHJcbiAgICAgICAgbGV0IHkgPSB0YXJnZXQuZ2V0Q29tcG9uZW50KCdlbGVtZW50JykuamlkXHJcbiAgICAgICAgbGV0IGlzU2luZ2xlID0gdHJ1ZVxyXG4gICAgICAgIGlmICgoeCAtIDEpID49IDAgJiYgdGhpcy5tYXBbeCAtIDFdW3ldLmdldENvbXBvbmVudCgnZWxlbWVudCcpLmNvbG9yID09IHRhcmdldC5nZXRDb21wb25lbnQoJ2VsZW1lbnQnKS5jb2xvcikge1xyXG4gICAgICAgICAgaXNTaW5nbGUgPSBmYWxzZVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoKHggKyAxKSA8IHRoaXMubWFwTGVuZ3RoICYmIHRoaXMubWFwW3ggKyAxXVt5XS5nZXRDb21wb25lbnQoJ2VsZW1lbnQnKS5jb2xvciA9PSB0YXJnZXQuZ2V0Q29tcG9uZW50KCdlbGVtZW50JykuY29sb3IpIHtcclxuICAgICAgICAgIGlzU2luZ2xlID0gZmFsc2VcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICgoeSAtIDEpID49IDAgJiYgdGhpcy5tYXBbeF1beSAtIDFdLmdldENvbXBvbmVudCgnZWxlbWVudCcpLmNvbG9yID09IHRhcmdldC5nZXRDb21wb25lbnQoJ2VsZW1lbnQnKS5jb2xvcikge1xyXG4gICAgICAgICAgaXNTaW5nbGUgPSBmYWxzZVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoKHkgKyAxKSA8IHRoaXMubWFwTGVuZ3RoICYmIHRoaXMubWFwW3hdW3kgKyAxXS5nZXRDb21wb25lbnQoJ2VsZW1lbnQnKS5jb2xvciA9PSB0YXJnZXQuZ2V0Q29tcG9uZW50KCdlbGVtZW50JykuY29sb3IpIHtcclxuICAgICAgICAgIGlzU2luZ2xlID0gZmFsc2VcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5tYXBbaV1bal0uZ2V0Q29tcG9uZW50KCdlbGVtZW50JykuaXNTaW5nbGUgPSBpc1NpbmdsZVxyXG4gICAgICAgIGNvbnNvbGUubG9nKGksIGosIHRoaXMubWFwW2ldW2pdLmdldENvbXBvbmVudCgnZWxlbWVudCcpLmlzU2luZ2xlLCB0aGlzLm1hcFtpXVtqXS5nZXRDb21wb25lbnQoJ2VsZW1lbnQnKS5jb2xvcilcclxuICAgICAgICBpZiAodGhpcy5ncm91cHNbaV1bal0ubGVuZ3RoID49IG1pbikge1xyXG4gICAgICAgICAgZm9yIChsZXQgeiA9IDA7IHogPCBwcm9wQ29uZmlnLmxlbmd0aDsgeisrKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmdyb3Vwc1tpXVtqXS5sZW5ndGggPD0gcHJvcENvbmZpZ1t6XS5tYXggJiYgdGhpcy5ncm91cHNbaV1bal0ubGVuZ3RoID49IHByb3BDb25maWdbel0ubWluKSB7XHJcbiAgICAgICAgICAgICAgdGhpcy53YXJuaW5nKHByb3BDb25maWdbel0udHlwZSwgdGhpcy5ncm91cHNbaV1bal0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9LFxyXG4gIHB1c2hQb3AodGFyZ2V0LCBpLCBqKSB7IC8v55So5LqO5Yik5pat5LiA5Liq5pa55Z2X5Zub5Liq5pa55ZCR5LiK55qE5pa55Z2X6aKc6Imy5piv5ZCm5LiA5qC3IOWmguaenOS4gOagt+WImeWKoOWFpee7hCDlpoLmnpznu4Tplb/luqblsI/kuo4x5YiZ6L+U5ZueZmFsc2U/XHJcbiAgICAvLyBpZiAodGFyZ2V0LmdldENvbXBvbmVudCgnZWxlbWVudCcpLmlzUHVzaD09dHJ1ZSkge1xyXG4gICAgLy8gICByZXR1cm5cclxuICAgIC8vIH1cclxuICAgIHRhcmdldC5nZXRDb21wb25lbnQoJ2VsZW1lbnQnKS5pc1B1c2ggPSB0cnVlXHJcbiAgICB0aGlzLmdyb3Vwc1tpXVtqXS5wdXNoKHRhcmdldClcclxuICAgIGxldCB4ID0gdGFyZ2V0LmdldENvbXBvbmVudCgnZWxlbWVudCcpLmlpZFxyXG4gICAgbGV0IHkgPSB0YXJnZXQuZ2V0Q29tcG9uZW50KCdlbGVtZW50JykuamlkXHJcbiAgICBpZiAoKHggLSAxKSA+PSAwKSB7XHJcbiAgICAgIGlmICghdGhpcy5tYXBbeCAtIDFdW3ldLmdldENvbXBvbmVudCgnZWxlbWVudCcpLmlzUHVzaCAmJiB0aGlzLm1hcFt4IC0gMV1beV0uZ2V0Q29tcG9uZW50KCdlbGVtZW50JykuY29sb3IgPT0gdGFyZ2V0LmdldENvbXBvbmVudCgnZWxlbWVudCcpLmNvbG9yKSB7XHJcbiAgICAgICAgdGhpcy5wdXNoUG9wKHRoaXMubWFwW3ggLSAxXVt5XSwgaSwgailcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgaWYgKCh4ICsgMSkgPCB0aGlzLm1hcExlbmd0aCkge1xyXG4gICAgICBpZiAoIXRoaXMubWFwW3ggKyAxXVt5XS5nZXRDb21wb25lbnQoJ2VsZW1lbnQnKS5pc1B1c2ggJiYgdGhpcy5tYXBbeCArIDFdW3ldLmdldENvbXBvbmVudCgnZWxlbWVudCcpLmNvbG9yID09IHRhcmdldC5nZXRDb21wb25lbnQoJ2VsZW1lbnQnKS5jb2xvcikge1xyXG4gICAgICAgIHRoaXMucHVzaFBvcCh0aGlzLm1hcFt4ICsgMV1beV0sIGksIGopXHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIGlmICgoeSAtIDEpID49IDApIHtcclxuICAgICAgaWYgKCF0aGlzLm1hcFt4XVt5IC0gMV0uZ2V0Q29tcG9uZW50KCdlbGVtZW50JykuaXNQdXNoICYmIHRoaXMubWFwW3hdW3kgLSAxXS5nZXRDb21wb25lbnQoJ2VsZW1lbnQnKS5jb2xvciA9PSB0YXJnZXQuZ2V0Q29tcG9uZW50KCdlbGVtZW50JykuY29sb3IpIHtcclxuICAgICAgICB0aGlzLnB1c2hQb3AodGhpcy5tYXBbeF1beSAtIDFdLCBpLCBqKVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBpZiAoKHkgKyAxKSA8IHRoaXMubWFwTGVuZ3RoKSB7XHJcbiAgICAgIGlmICghdGhpcy5tYXBbeF1beSArIDFdLmdldENvbXBvbmVudCgnZWxlbWVudCcpLmlzUHVzaCAmJiB0aGlzLm1hcFt4XVt5ICsgMV0uZ2V0Q29tcG9uZW50KCdlbGVtZW50JykuY29sb3IgPT0gdGFyZ2V0LmdldENvbXBvbmVudCgnZWxlbWVudCcpLmNvbG9yKSB7XHJcbiAgICAgICAgdGhpcy5wdXNoUG9wKHRoaXMubWFwW3hdW3kgKyAxXSwgaSwgailcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIOWIpOaWreaWueWdl+aYr+WQpuWNlei6q1xyXG5cclxuICB9LFxyXG4gIHdhcm5pbmcodHlwZSwgZ3JvdXApIHtcclxuICAgIGdyb3VwLm1hcChpdGVtID0+IHtcclxuICAgICAgaXRlbS5nZXRDb21wb25lbnQoJ2VsZW1lbnQnKS5vbldhcm5pbmcodHlwZSlcclxuICAgIH0pXHJcbiAgfVxyXG59KTsiXX0=