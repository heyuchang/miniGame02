{"version":3,"sources":["assets\\Script\\element.js"],"names":["cc","Class","Component","properties","_status","_itemType","warningSprite","Sprite","lightSprite","init","g","data","width","itemType","pos","_game","x","y","warningType","isPush","bindEvent","color","Math","ceil","random","colorSprite","node","getChildByName","getComponent","spriteFrame","propSpriteFrame","blockSprite","_width","_controller","active","height","startTime","iid","jid","gap","angle","playStartAction","onWarning","type","warningSpriteFrame","action1","blink","warningInit","growInit","growType","grow","on","Node","EventType","TOUCH_START","onTouched","isChain","isBomb","time","setTimeout","JSON","stringify","self","playDieAction","then","onBlockPop","isSingle","scale","_score","tipBox","scaleTo","action2","easing","easeBackOut","action","sequence","runAction","onUserTouched","onStep","res","checkNeedFall","musicManager","onPlayAudio","onItem","addScore","v2","config","json","propConfig","score","map","rowNum","playFallAction","moveBy","blockWidth","easeBounceOut","seq","callFunc","scaleX","scaleY","animationSpeed","clearTimeout","surfaceTimer","stopAllActions","Promise","resolve","reject","moveTo","target","action3","spawn","surfaceAction","dela","generatePropAction","generateItem"],"mappings":"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","sourceRoot":"/","sourcesContent":["/**\n * @author heyuchang\n * @file 单个方块控制\n */\ncc.Class({\n  extends: cc.Component,\n  properties: {\n    _status: 0, //1为可触发点击 2为已经消失\n    _itemType: 0, //新增道具功能 1为双倍倍数 2为炸弹\n    warningSprite: cc.Sprite,\n    lightSprite: cc.Sprite,\n  },\n  init(g, data, width, itemType, pos) {\n    this._game = g\n    this._status = 1\n    if (pos) {\n      //cc.log('生成的方块', pos)\n    }\n    pos = pos || {\n      x: data.x,\n      y: data.y\n    }\n    this._itemType = itemType || 0\n    this.warningType = 0\n    this.isPush = false\n    this.bindEvent()\n    this.color = data.color || Math.ceil(Math.random() * 4)\n    this.colorSprite = this.node.getChildByName('color').getComponent(cc.Sprite)\n    this.colorSprite.spriteFrame = itemType ? g.propSpriteFrame[(itemType - 1) * 4 + this.color - 1] : this._game.blockSprite[this.color - 1]\n    this.warningSprite.spriteFrame = ''\n    this._width = width\n    this._controller = g._controller\n    // 计算宽\n    this.lightSprite.node.active = false\n    //  this.lightSprite.spriteFrame = this._game.blockSprite[this.color - 1]\n    this.node.width = this.node.height = width\n    this.startTime = data.startTime\n    this.iid = data.y\n    this.jid = data.x\n    // console.log('生成方块位置', data.y, data.x)\n    this.node.x = -(730 / 2 - g.gap - width / 2) + pos.x * (width + g.gap)\n    this.node.y = (730 / 2 - g.gap - width / 2) - pos.y * (width + g.gap)\n    this.node.angle = 0\n    this.playStartAction()\n  },\n  onWarning(type) {\n    this.warningSprite.spriteFrame = this._game.warningSpriteFrame[type - 1] || ''\n    this.warningType = type\n    //   this.lightSprite.node.active = true\n    let action1 = cc.blink(1, 10)\n    //   this.lightSprite.node.runAction(action1)\n  },\n  warningInit() {\n    this.warningSprite.spriteFrame = ''\n    //  this.lightSprite.node.active = false\n    this.isPush = false\n  },\n  growInit() {\n    this.growType = 0\n    this.colorSprite.node.height = this.colorSprite.node.width = this._width\n    this.colorSprite.node.y = this.colorSprite.node.x = 0\n  },\n  grow(type) { //1234 上下左右\n    switch (type) {\n      case 1:\n        if (this.growType != 2) {\n          this.colorSprite.node.height += this._game.gap * 2\n          this.colorSprite.node.y += this._game.gap\n          this.growType = 1\n        }\n        break\n      case 2:\n        if (this.growType != 2) {\n          this.colorSprite.node.height += this._game.gap * 2\n          this.colorSprite.node.y -= this._game.gap\n          this.growType = 1\n        }\n        break\n      case 3:\n        if (this.growType != 1) {\n          this.colorSprite.node.width += this._game.gap * 2\n          this.colorSprite.node.x -= this._game.gap\n          this.growType = 2\n        }\n        break\n      case 4:\n        if (this.growType != 1) {\n          this.colorSprite.node.width += this._game.gap * 2\n          this.colorSprite.node.x += this._game.gap\n          this.growType = 2\n        }\n        break\n    }\n  },\n  bindEvent() {\n    this.node.on(cc.Node.EventType.TOUCH_START, this.onTouched, this)\n\n  },\n  // 用户点击 或者被其他方块触发\n  onTouched(color, isChain, isBomb, time) { //道具新增参数 isChain是否连锁 isBomb是否强制消除\n    if (time) {\n      setTimeout(() => {\n        this.onTouched(color, false, isBomb)\n      }, time)\n      return\n    }\n    isChain = JSON.stringify(isChain) == 'null' ? true : isChain\n    isBomb = isBomb ? isBomb : false\n    let self = this\n    // 爆炸触发\n    if (this._status == 1 && isBomb == true) {\n      this._status = 2\n      this.playDieAction().then(() => {\n        this.onBlockPop(color, isChain, isBomb)\n      })\n      return\n    }\n\n    if (color.type) {\n      // 一定是用户主动触发 保存这个坐标给game\n      if (this.isSingle && this._itemType <= 1) {\n        this.node.scale = 1\n        this._game._score.tipBox.init(this._game._score, 3)\n        let action1 = cc.scaleTo(0.1, 1.1, 0.9)\n        let action2 = cc.scaleTo(0.3, 1).easing(cc.easeBackOut(2.0))\n        let action = cc.sequence(action1, action2)\n        this.node.runAction(action)\n        return\n      }\n      // console.log('方块位置', this.iid, this.jid, this._itemType)\n      color = this.color\n      if (this._status == 1 && this._game._status == 1 && this.color == color) {\n        this._game.onUserTouched(this.iid, this.jid, this._itemType, this.color, this.warningType, {\n          x: this.node.x,\n          y: this.node.y\n        })\n        this._game._score.onStep(-1).then((res) => {\n          if (res) {\n            this.playDieAction().then(() => {\n              this.onBlockPop(color, null, null)\n            })\n          }\n        })\n      }\n    } else {\n      // 由其他方块触发\n      if (this._status == 1 && this._game._status == 5 && this.color == color) {\n        this.playDieAction().then(() => {\n          this.onBlockPop(color, null, null)\n        })\n      }\n    }\n  },\n  onBlockPop(color, isChain, isBomb) {\n    let self = this\n    isChain = JSON.stringify(isChain) == 'null' ? true : isChain\n    isBomb = isBomb ? isBomb : false\n    self._game.checkNeedFall()\n    self._game._status = 5\n    self._controller.musicManager.onPlayAudio(0\n      //self._game._score.chain - 1\n    )\n    if (this._itemType != 0) {\n      // console.log(\"触发了道具\", this._itemType)\n\n      self._game.onItem(this._itemType, color, {\n        x: this.node.x,\n        y: this.node.y\n      })\n    }\n    self._game._score.addScore(cc.v2(this.node.x, this.node.y - this.node.width + this._game.gap), this._itemType == 3 ? this._game._controller.config.json.propConfig[2].score : null)\n\n    // 连锁状态\n    if (isChain) {\n      if ((self.iid - 1) >= 0) {\n        self._game.map[self.iid - 1][self.jid].getComponent('element').onTouched(color)\n      }\n      if ((self.iid + 1) < this._game.rowNum) {\n        self._game.map[self.iid + 1][self.jid].getComponent('element').onTouched(color)\n      }\n      if ((self.jid - 1) >= 0) {\n        self._game.map[self.iid][self.jid - 1].getComponent('element').onTouched(color)\n      }\n      if ((self.jid + 1) < this._game.rowNum) {\n        self._game.map[self.iid][self.jid + 1].getComponent('element').onTouched(color)\n      }\n    }\n  },\n  playFallAction(y, data) { //下降了几个格子\n    this._status = 0\n    if (data) {\n      this.iid = data.y\n      this.jid = data.x\n    }\n    let action = cc.moveBy(0.25, 0, -y * (this._game.gap + this._game.blockWidth)).easing(cc.easeBounceOut(5 / y)) //1 * y / this._game.animationSpeed\n    let seq = cc.sequence(action, cc.callFunc(() => {\n      this._status = 1\n      //  this._game.checkNeedGenerator()\n    }, this))\n    this.node.runAction(seq)\n  },\n  playStartAction() {\n    this.node.scaleX = 0\n    this.node.scaleY = 0\n    let action = cc.scaleTo(0.8 / this._game.animationSpeed, 1, 1).easing(cc.easeBackOut())\n    let seq = cc.sequence(action, cc.callFunc(() => {\n      this._status = 1\n    }, this))\n    // 如果有延迟时间就用延迟时间\n    if (this.startTime) {\n      setTimeout(() => {\n          this.node.runAction(seq)\n        }, this.startTime / 1\n        // (cc.game.getFrameRate() / 60)\n      )\n    } else {\n      this.node.runAction(seq)\n    }\n  },\n  playDieAction() {\n    let self = this\n    clearTimeout(this.surfaceTimer)\n    this.node.stopAllActions()\n    this._status = 2\n    this.node.scaleX = 1\n    this.node.scaleY = 1\n    return new Promise((resolve, reject) => {\n      let action\n      if (this.warningSprite.spriteFrame) { //有道具预警\n        let action1 = cc.scaleTo(0.2 / self._game.animationSpeed, 1.1)\n        let action2 = cc.moveTo(0.2 / self._game.animationSpeed, this._game.target.x, this._game.target.y)\n        let action3 = cc.scaleTo(0.2, 0)\n        var seq = cc.sequence(action1, cc.callFunc(() => {\n          resolve('')\n        }, this), cc.spawn(action2, action3))\n      } else {\n        action = cc.scaleTo(0.2 / self._game.animationSpeed, 0, 0)\n        var seq = cc.sequence(action, cc.callFunc(() => {\n          resolve('')\n        }, this))\n      }\n      self.node.runAction(seq)\n    });\n  },\n  surfaceAction(dela) {\n    this.surfaceTimer = setTimeout(() => {\n      let action = cc.scaleTo(0.4 / this._game.animationSpeed, 0.8, 0.8)\n      let action1 = cc.scaleTo(0.4 / this._game.animationSpeed, 1, 1)\n      this.node.runAction(cc.sequence(action, action1))\n    }, dela)\n  },\n  generatePropAction() {\n\n  },\n  generateItem(type) {\n    this._itemType = type\n  },\n});"]}