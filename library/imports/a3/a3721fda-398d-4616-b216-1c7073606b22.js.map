{"version":3,"sources":["assets\\Script\\check.js"],"names":["cc","Class","Component","properties","groups","map","mapLength","init","g","_game","rowNum","i","j","getComponent","isSingle","warningInit","check","propConfig","_controller","config","json","min","length","pushPop","target","x","iid","y","jid","color","console","log","z","max","warning","type","isPush","push","group","item","onWarning"],"mappings":"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","sourceRoot":"/","sourcesContent":["/**\n * @author heyuchang\n * @file 检测组件\n */\ncc.Class({\n  extends: cc.Component,\n  properties: {\n    groups: [],\n    map: [],\n    mapLength: 8\n  },\n  init(g) {\n    this._game = g\n    this.map = g.map\n    this.mapLength = g.rowNum\n    for (let i = 0; i < this.mapLength; i++) { //行\n      this.groups[i] = []\n      for (let j = 0; j < this.mapLength; j++) { //列\n        // this.map[i][j].getComponent('element').growInit() //全部初始化\n        if (!this.map[i][j]) {\n          //    cc.log('报错x,y:', i, j)\n        }\n        this.map[i][j].getComponent('element').isSingle = false\n        this.map[i][j].getComponent('element').warningInit()\n        this.groups[i][j] = []\n      }\n    }\n  },\n  check(g) { //该函数主要用于检测一个区块能否形成道具等\n    let propConfig = g._controller.config.json.propConfig\n    this._game = g\n    this.map = g.map\n    this.mapLength = g.rowNum\n    let min = 999\n    for (let i = 0; i < propConfig.length; i++) {\n      min = propConfig[i].min < min ? propConfig[i].min : min\n    }\n    for (let i = 0; i < this.mapLength; i++) { //行\n      for (let j = 0; j < this.mapLength; j++) { //列\n        this.pushPop(this.map[i][j], i, j)\n        let target = this.map[i][j]\n        let x = target.getComponent('element').iid\n        let y = target.getComponent('element').jid\n        let isSingle = true\n        if ((x - 1) >= 0 && this.map[x - 1][y].getComponent('element').color == target.getComponent('element').color) {\n          isSingle = false\n        }\n        if ((x + 1) < this.mapLength && this.map[x + 1][y].getComponent('element').color == target.getComponent('element').color) {\n          isSingle = false\n        }\n\n        if ((y - 1) >= 0 && this.map[x][y - 1].getComponent('element').color == target.getComponent('element').color) {\n          isSingle = false\n        }\n        if ((y + 1) < this.mapLength && this.map[x][y + 1].getComponent('element').color == target.getComponent('element').color) {\n          isSingle = false\n        }\n        this.map[i][j].getComponent('element').isSingle = isSingle\n        console.log(i, j, this.map[i][j].getComponent('element').isSingle, this.map[i][j].getComponent('element').color)\n        if (this.groups[i][j].length >= min) {\n          for (let z = 0; z < propConfig.length; z++) {\n            if (this.groups[i][j].length <= propConfig[z].max && this.groups[i][j].length >= propConfig[z].min) {\n              this.warning(propConfig[z].type, this.groups[i][j])\n            }\n          }\n        }\n      }\n    }\n  },\n  pushPop(target, i, j) { //用于判断一个方块四个方向上的方块颜色是否一样 如果一样则加入组 如果组长度小于1则返回false?\n    // if (target.getComponent('element').isPush==true) {\n    //   return\n    // }\n    target.getComponent('element').isPush = true\n    this.groups[i][j].push(target)\n    let x = target.getComponent('element').iid\n    let y = target.getComponent('element').jid\n    if ((x - 1) >= 0) {\n      if (!this.map[x - 1][y].getComponent('element').isPush && this.map[x - 1][y].getComponent('element').color == target.getComponent('element').color) {\n        this.pushPop(this.map[x - 1][y], i, j)\n      }\n    }\n    if ((x + 1) < this.mapLength) {\n      if (!this.map[x + 1][y].getComponent('element').isPush && this.map[x + 1][y].getComponent('element').color == target.getComponent('element').color) {\n        this.pushPop(this.map[x + 1][y], i, j)\n      }\n    }\n    if ((y - 1) >= 0) {\n      if (!this.map[x][y - 1].getComponent('element').isPush && this.map[x][y - 1].getComponent('element').color == target.getComponent('element').color) {\n        this.pushPop(this.map[x][y - 1], i, j)\n      }\n    }\n    if ((y + 1) < this.mapLength) {\n      if (!this.map[x][y + 1].getComponent('element').isPush && this.map[x][y + 1].getComponent('element').color == target.getComponent('element').color) {\n        this.pushPop(this.map[x][y + 1], i, j)\n      }\n    }\n\n    // 判断方块是否单身\n\n  },\n  warning(type, group) {\n    group.map(item => {\n      item.getComponent('element').onWarning(type)\n    })\n  }\n});"]}